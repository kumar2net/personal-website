# Android Play Store Deployment Guide

## Overview
This guide covers deploying Kumar's Portfolio PWA to the Android Play Store using Trusted Web Activity (TWA).

## Prerequisites

### 1. Android Development Environment
- **Android Studio**: Latest version with Android SDK
- **Java Development Kit (JDK)**: Version 8 or higher
- **Gradle**: Included with Android Studio
- **Android SDK Build Tools**: API level 34

### 2. Google Play Console Account
- Google Play Developer account ($25 one-time fee)
- App signing key (generated by Google Play Console)

### 3. Domain Verification
- SSL certificate for your domain
- Digital Asset Links file deployed

## Project Structure

```
android/
├── app/
│   ├── build.gradle                 # App-level build configuration
│   ├── src/main/
│   │   ├── AndroidManifest.xml      # App manifest with TWA configuration
│   │   ├── res/
│   │   │   ├── values/
│   │   │   │   ├── strings.xml      # App strings and asset statements
│   │   │   │   ├── colors.xml       # App colors
│   │   │   │   └── themes.xml       # App themes
│   │   │   └── mipmap-*/           # App icons in different densities
│   │   └── proguard-rules.pro      # ProGuard configuration
│   └── release.keystore            # Release signing keystore
├── build.gradle                    # Project-level build configuration
├── settings.gradle                 # Project settings
└── gradle.properties              # Gradle properties

play-store/
├── listing.md                     # Play Store listing content
├── screenshots/                   # App screenshots
└── assets/                       # Play Store assets

public/.well-known/
└── assetlinks.json               # Digital Asset Links for domain verification
```

## Step-by-Step Deployment

### 1. Environment Setup

```bash
# Install Android Studio from https://developer.android.com/studio
# Set up Android SDK and accept licenses
sdkmanager --licenses

# Verify installation
android --version
java -version
```

### 2. Build Android App

```bash
# Navigate to project root
cd /Users/kumar/personal-website

# Run the Android build script
node scripts/build-android.mjs
```

### 3. Generate Signing Key

```bash
# Generate release keystore (if not already generated)
keytool -genkey -v -keystore android/app/release.keystore \
  -alias portfolio -keyalg RSA -keysize 2048 -validity 10000 \
  -storepass android -keypass android \
  -dname "CN=Kumar Portfolio, OU=Development, O=Kumar, L=City, S=State, C=US"
```

### 4. Configure App Signing

Create `android/app/build.gradle` signing configuration:

```gradle
android {
    signingConfigs {
        release {
            storeFile file('release.keystore')
            storePassword 'android'
            keyAlias 'portfolio'
            keyPassword 'android'
        }
    }
    buildTypes {
        release {
            signingConfig signingConfigs.release
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }
}
```

### 5. Domain Verification

#### Deploy Digital Asset Links
The `assetlinks.json` file is already created at `public/.well-known/assetlinks.json`. After building your app, you'll need to:

1. Get your app's SHA256 fingerprint:
```bash
keytool -list -v -keystore android/app/release.keystore -alias portfolio
```

2. Update the fingerprint in `assetlinks.json`:
```json
[{
  "relation": ["delegate_permission/common.handle_all_urls"],
  "target": {
    "namespace": "android_app",
    "package_name": "com.kumar.portfolio",
    "sha256_cert_fingerprints": ["YOUR_ACTUAL_SHA256_FINGERPRINT"]
  }
}]
```

3. Deploy to your domain at `https://kumarsite.netlify.app/.well-known/assetlinks.json`

### 6. Play Store Console Setup

#### Create New App
1. Go to [Google Play Console](https://play.google.com/console)
2. Click "Create app"
3. Fill in app details:
   - **App name**: Kumar's Portfolio
   - **Default language**: English (United States)
   - **App or game**: App
   - **Free or paid**: Free

#### Upload APK
1. Go to "Release" → "Production"
2. Click "Create new release"
3. Upload the signed APK from `android/app/build/outputs/apk/release/app-release.apk`
4. Add release notes

#### Complete Store Listing
1. **App details**:
   - Short description: "Personal portfolio with push notifications for blog updates and comments"
   - Full description: Use content from `play-store/listing.md`

2. **Graphics**:
   - App icon: 512x512 PNG
   - Feature graphic: 1024x500 PNG
   - Screenshots: 1280x720 (desktop), 390x844 (mobile)

3. **Content rating**: Everyone

4. **Target audience**: 18+ (professional audience)

5. **App category**: Productivity

6. **Contact details**:
   - Website: https://kumarsite.netlify.app
   - Email: kumar@example.com
   - Phone: (optional)

### 7. Privacy Policy
Create a privacy policy covering:
- Data collection (push notification subscriptions)
- Third-party services (Disqus, Netlify)
- User rights and data deletion

Deploy at: `https://kumarsite.netlify.app/privacy`

### 8. Submit for Review
1. Complete all required sections
2. Review app information
3. Submit for review
4. Wait for Google's approval (typically 1-3 days)

## Testing

### Local Testing
```bash
# Install debug APK on device
adb install android/app/build/outputs/apk/debug/app-debug.apk

# Test TWA functionality
# - App opens in fullscreen
# - No browser UI visible
# - Push notifications work
# - Offline functionality works
```

### Play Store Testing
1. Upload to Internal Testing track first
2. Test with internal testers
3. Move to Closed Testing if needed
4. Finally, release to Production

## Troubleshooting

### Common Issues

1. **Domain verification fails**:
   - Ensure `assetlinks.json` is accessible at `https://yourdomain.com/.well-known/assetlinks.json`
   - Verify SHA256 fingerprint matches your keystore
   - Check that the file is served with `Content-Type: application/json`

2. **TWA doesn't open in fullscreen**:
   - Verify Digital Asset Links are properly configured
   - Check that the domain in `AndroidManifest.xml` matches your actual domain
   - Ensure the app is signed with the correct keystore

3. **Push notifications don't work**:
   - Verify VAPID keys are correctly configured
   - Check that the service worker is properly registered
   - Test notification permissions in the app

4. **Build errors**:
   - Ensure Android SDK is properly installed
   - Check that all required build tools are available
   - Verify Gradle version compatibility

### Debug Commands

```bash
# Check Android SDK
android list sdk

# Verify keystore
keytool -list -v -keystore android/app/release.keystore

# Test domain verification
curl -H "Accept: application/json" https://kumarsite.netlify.app/.well-known/assetlinks.json

# Check APK signature
aapt dump badging android/app/build/outputs/apk/release/app-release.apk
```

## Post-Deployment

### Monitoring
- Monitor app performance in Play Console
- Track crash reports and ANRs
- Review user feedback and ratings

### Updates
- Use the same process for app updates
- Increment version code in `build.gradle`
- Test thoroughly before releasing updates

### Analytics
- Integrate Firebase Analytics for app usage tracking
- Monitor PWA metrics (installations, engagement)
- Track push notification effectiveness

## Security Considerations

1. **Keystore Security**:
   - Store keystore securely (not in version control)
   - Use strong passwords
   - Backup keystore safely

2. **Domain Security**:
   - Use HTTPS everywhere
   - Implement proper CSP headers
   - Regular security audits

3. **Data Privacy**:
   - Comply with GDPR/CCPA
   - Implement data deletion
   - Transparent privacy policy

## Success Metrics

- ✅ App successfully published to Play Store
- ✅ TWA opens in fullscreen mode
- ✅ Push notifications work correctly
- ✅ Offline functionality works
- ✅ Domain verification successful
- ✅ No critical crashes or ANRs
- ✅ Positive user ratings (>4.0 stars)

## Resources

- [Trusted Web Activity Documentation](https://developer.chrome.com/docs/android/trusted-web-activity/)
- [Google Play Console Help](https://support.google.com/googleplay/android-developer/)
- [Digital Asset Links](https://developers.google.com/digital-asset-links)
- [PWA Best Practices](https://web.dev/pwa-checklist/)
